---
title: "Lab 05_Brownian Motion"
author: "STA 2060A - Stochastic Processes"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Realization of a Brownian motion process from the same random process

Suppose ${X(t), t \geq 0}$ is a Brownian motion process, with drift parameter 0 and diffusion parameter $\sigma^2$ where $\sigma = 0.5, 1, 1.7$, obtain the realization, when it is observed for the interval [0, 10]

### Part I: Input the parameters

```{r}

sig1=.5; sig2=1.7

```


### Part II: Realization
```{r}

h=.02; t=seq(0,10,h); n=length(t); n
u=y=z=x=c(); y[1]=z[1]=x[1]=0
for(i in 2:n)
{
set.seed(i)
u[i]=rnorm(1,0,1)
x[i]=x[i-1]+ u[i]*sqrt(h)
y[i]=y[i-1]+ u[i]*sqrt(h)*sig1
z[i]=z[i-1]+ u[i]*sqrt(h)*sig2
}
M=max(x);M;m=min(x);m; M1=max(y);M1;m1=min(y);m1
M2=max(z);M2;m2=min(z);m2
w=round(c(m2,-4,m,-2,m1,0,M1,2,M,4,M2),2);w

```


### Part III: Graph of realization

```{r}

plot(t,x,"l",ylab="Realized values",xlab="t",yaxt="n",col="blue",
main="Realization of a Brownian motion Process with Different Sigma",
ylim=c(m2,6.5),lwd=2)
axis(2,at=w,las=2,cex.axis=0.8)
lines(t,y,"l",col="dark green",lty=2,lwd=2)
lines(t,z,"l",col="dark red",lty=4,lwd=2)
abline(h=0,col="dark blue"); abline(h=M,col="blue")
abline(h=m,col="blue"); abline(h=M1,lty=2,col="dark green")
abline(h=m1,lty=2,col="dark green")
abline(h=M2,lty=4,col="dark red")
abline(h=m2,lty=4,col="dark red")
legend("topleft",legend=c("sigma=0.5","sigma=1","sigma=1.7"),
cex=.7,col=c("dark green","blue","dark red"),lty=c(2,1,4))

```


## Realization of a Brownian motion process from different random samples

This next example also presents a realization of the Brownian motion process, but we adopt a slightly different approach. In the above example, the random sample from the standard normal distribution is the same for three realizations; only the values of diffusion coefficients are different.

In this code, we draw different random samples from the standard normal distribution corresponding to different values of diffusion coefficients as $\sigma = 0.5, 1, 1.7$, when the process is observed for the interval [0, 10]

### Part I: Input the parameters

```{r}

sig1=.5; sig2=1.7

```

### Part II: Realization

```{r}

del=.02; t=seq(0,10,del); n=length(t); n
y=z=x=c(); y[1]=z[1]=x[1]=0;
for(i in 2:n)
{
set.seed(i)
x[i]=x[i-1]+rnorm(1,0,sqrt(del))
y[i]=y[i-1]+rnorm(1,0,sig1*sqrt(del))
z[i]=z[i-1]+rnorm(1,0,sig2*sqrt(del))
}
M=max(x);M;m=min(x); m; M1=max(y);M1;m1=min(y);m1
M2=max(z);M2;m2=min(z);m2
w=round(c(m2,m,-2,m1,0,M1,2,M,4,M2),2);w

```


### Part III: Graph of the realization

```{r}

plot(t,x,"l",main="Realizations of Brownian motion Processes",
ylab="Realized values",xlab="t",yaxt="n",col="blue",
ylim=c(m2,5.5),lwd=2)
axis(2,at=w,las=2,cex.axis=0.8)
lines(t,y,"l",col="dark green",lty=2,lwd=2)
lines(t,z,"l",col="dark red",lty=4,lwd=2)
abline(h=0,col="dark blue")
abline(h=M,col="blue")
abline(h=m,col="blue")
abline(h=M1,lty=2,col="dark green")
abline(h=m1,lty=2,col="dark green")
abline(h=M2,lty=4,col="dark red")
abline(h=m2,lty=4,col="dark red")
legend("topleft",legend=c("sigma=0.5","sigma=1","sigma=1.7"),
cex=.7,col=c("dark green","blue","dark red"),lty=c(2,1,4))

```

